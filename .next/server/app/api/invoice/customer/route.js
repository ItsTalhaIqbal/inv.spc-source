"use strict";(()=>{var e={};e.id=4963,e.ids=[4963],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},85018:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>h,originalPathname:()=>j,requestAsyncStorage:()=>f,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>w,staticGenerationBailout:()=>y});var s={};t.r(s),t.d(s,{DELETE:()=>DELETE,GET:()=>GET,OPTIONS:()=>OPTIONS,POST:()=>POST,PUT:()=>PUT}),t(78976);var n=t(10884),a=t(16132),o=t(95798),i=t(8590),u=t(11185),d=t.n(u);let l=new u.Schema({name:{type:String,required:!0},address:{type:String,required:!0},state:{type:String,required:!0},country:{type:String,default:"UAE"},email:{type:String,required:!0,unique:!0},phone:{type:String,required:!0}},{timestamps:!0}),c=d().models.Customer||d().model("Customer",l),m=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;async function OPTIONS(e){return o.Z.json({},{status:204,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization"}})}async function GET(e){try{await (0,i.v)();let{searchParams:r}=new URL(e.url),t=r.get("id");if(t){let e=await c.findOne({_id:t}).select("-password");if(!e)return o.Z.json({error:"Customer not found"},{status:404});let r={_id:e._id.toString(),name:e.name,address:e.address,state:e.state,country:e.country,email:e.email,phone:e.phone};return o.Z.json(r,{status:200,headers:{"Access-Control-Allow-Origin":"*"}})}{let e=await c.find().select("-password"),r=e.map(e=>({_id:e._id.toString(),name:e.name,address:e.address,state:e.state,country:e.country,email:e.email,phone:e.phone}));return o.Z.json(r,{status:200,headers:{"Access-Control-Allow-Origin":"*"}})}}catch(e){return o.Z.json({error:"Internal server error",details:e.message},{status:500})}}async function POST(e){try{await (0,i.v)();let r=await e.json(),{name:t,address:s,state:n,country:a,email:u,phone:d}=r;if(!t||!s||!n||!a||!u||!d)return o.Z.json({error:"Missing required fields",missing:{name:t,address:s,state:n,country:a,email:u,phone:d}},{status:400});if(!m.test(u))return o.Z.json({error:"Invalid email format"},{status:400});let l=await c.findOne({email:u});if(l)return o.Z.json({error:"Email already exists"},{status:409});let p=await c.create({name:t,address:s,state:n,country:a,email:u,phone:d}),f={_id:p._id.toString(),name:p.name,address:p.address,state:p.state,country:p.country,email:p.email,phone:p.phone};return o.Z.json(f,{status:201,headers:{"Access-Control-Allow-Origin":"*"}})}catch(e){return console.error("Error in POST /api/invoice/user:",e),o.Z.json({error:"Internal server error",details:e.message,stack:e.stack},{status:500})}}async function PUT(e){try{await (0,i.v)();let r=await e.json(),{name:t,address:s,state:n,country:a,email:u,phone:d,_id:l}=r;if(!l)return o.Z.json({error:"Customer ID is required"},{status:400});if(u&&!m.test(u))return o.Z.json({error:"Invalid email format"},{status:400});if(t&&(t.length<2||t.length>100))return o.Z.json({error:"Name must be between 2 and 100 characters"},{status:400});if(u){let e=await c.findOne({email:u,_id:{$ne:l}});if(e)return o.Z.json({error:"Email already exists for this name ."},{status:409})}let p={};t&&(p.name=t),s&&(p.address=s),n&&(p.state=n),a&&(p.country=a),u&&(p.email=u),d&&(p.phone=d);let f=await c.findByIdAndUpdate(l,p,{new:!0}).select("-password");if(!f)return o.Z.json({error:"Customer not found"},{status:404});return o.Z.json(!0,{status:200,headers:{"Access-Control-Allow-Origin":"*"}})}catch(e){return o.Z.json({error:"Internal server error",details:e.message},{status:500})}}async function DELETE(e){try{await (0,i.v)();let{searchParams:r}=new URL(e.url),t=r.get("id");if(!t)return o.Z.json({error:"Customer ID is required"},{status:400});let s=await c.findByIdAndDelete(t);if(!s)return o.Z.json({error:"Customer not found"},{status:404});return o.Z.json(!0,{status:200,headers:{"Access-Control-Allow-Origin":"*"}})}catch(e){return o.Z.json({error:"Internal server error",details:e.message},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/invoice/customer/route",pathname:"/api/invoice/customer",filename:"route",bundlePath:"app/api/invoice/customer/route"},resolvedPagePath:"C:\\Users\\Hammad\\Desktop\\checks\\Invoice_app\\app\\api\\invoice\\customer\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:w,serverHooks:g,headerHooks:h,staticGenerationBailout:y}=p,j="/api/invoice/customer/route"}};var r=require("../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[4961,4933,8590],()=>__webpack_exec__(85018));module.exports=t})();